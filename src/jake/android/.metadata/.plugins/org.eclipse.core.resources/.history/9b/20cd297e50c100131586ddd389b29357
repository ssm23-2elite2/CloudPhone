package com.example.cloudphonesimpletest.util;

import java.util.List;

import com.example.cloudphonesimpletest.CloudPhoneService;

import android.app.ActivityManager;
import android.app.ActivityManager.RunningServiceInfo;
import android.content.ComponentName;
import android.content.Context;
import android.content.Intent;
import android.util.Log;

public class Util {
	public static class Services{
		/**
		 * Check PassUService is running or not.
		 * @param context Application/Activity's context
		 * @return <code>true</code> if PassUService is running, <code>false</code> otherwise.
		 */
		public static boolean isServiceAliveU(Context context){
			String serviceCls = CloudPhoneService.class.getName();
			ActivityManager manager = (ActivityManager)context.getSystemService(Context.ACTIVITY_SERVICE);
			List<RunningServiceInfo> serviceList = manager.getRunningServices(Integer.MAX_VALUE);
			for(RunningServiceInfo info : serviceList){
				if(info.service.getClassName().equals(serviceCls)){
					return true;
				}
			}
			return false;
		}

		/**
		 * Starts PassUService.
		 * @param context Application/Activity's context
		 * @see org.secmem232.passu.android.mouse.PassUService PassUService
		 */
		public static ComponentName startPassUService(Context context, String ip, int port){
			if(!isServiceAliveU(context)){
				Intent intent = new Intent(context, CloudPhoneService.class);
				return context.startService(intent);
			} else {
				return null;
			}
		}
	}
	
}
